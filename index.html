<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V20 Character Creator</title>
    <!-- Tailwind CSS (via CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts: Gothic/Vampire feel -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-black text-[#d4af37] font-lato overflow-hidden h-screen flex flex-col">

    <!-- NOTIFICATION AREA -->
    <div id="notification" class="hidden fixed top-4 right-4 bg-red-900 border border-red-500 text-white px-4 py-2 rounded shadow-xl z-50 font-cinzel"></div>

    <!-- LOADING OVERLAY -->
    <div id="loading-overlay" class="fixed inset-0 bg-black z-[100] flex flex-col items-center justify-center">
        <div class="text-[#d4af37] font-cinzel text-2xl animate-pulse">Initializing V20 Archives...</div>
        <div class="text-gray-500 text-sm mt-2">Connecting to Bloodline Database</div>
    </div>

    <!-- MAIN APP WRAPPER -->
    <div class="flex-1 flex flex-col h-full max-w-7xl mx-auto w-full relative">
        
        <!-- HEADER / TOP BAR -->
        <header class="flex justify-between items-center p-4 border-b border-[#333] bg-[#0a0a0a]">
            <div class="flex items-center gap-4">
                <h1 class="text-2xl font-cinzel text-white tracking-widest">VAMPIRE <span class="text-red-700 text-sm align-top">20th</span></h1>
                <div class="h-6 w-px bg-[#333]"></div>
                <div id="cmd-bar" class="flex gap-2">
                    <button id="cmd-new" class="cmd-btn" title="New Character"><i class="fas fa-file"></i></button>
                    <button id="cmd-save" class="cmd-btn" title="Save Character"><i class="fas fa-save"></i></button>
                    <button id="cmd-load" class="cmd-btn" title="Load Character"><i class="fas fa-folder-open"></i></button>
                </div>
            </div>
            
            <div class="flex items-center gap-4">
                <button id="toggle-freebie-btn" class="border border-blue-900 text-blue-300 px-3 py-1 rounded text-xs uppercase tracking-wider hover:bg-blue-900/40 transition-colors" disabled>
                    <span id="freebie-btn-text">Freebies</span>
                </button>
                <button id="play-mode-btn" class="border border-[#d4af37] text-[#d4af37] px-4 py-1 rounded text-sm font-bold uppercase tracking-widest hover:bg-[#d4af37] hover:text-black transition-all shadow-[0_0_10px_rgba(212,175,55,0.2)]">
                    <span id="play-btn-text">PLAY</span>
                </button>
            </div>
        </header>

        <!-- NAVIGATION TABS (Creation Mode) -->
        <nav id="sheet-nav" class="flex justify-between bg-[#111] px-4 py-2 border-b border-[#333] overflow-x-auto gap-2"></nav>

        <!-- CONTENT AREA -->
        <main class="flex-1 overflow-y-auto p-6 relative custom-scrollbar bg-[url('https://www.transparenttextures.com/patterns/dark-matter.png')]">
            
            <!-- === PHASE 1: CONCEPT === -->
            <div id="phase-1" class="step-container active">
                <h2 class="section-title">Concept & Identity</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" id="c-name" class="v-input" placeholder="Name of Character">
                    </div>
                    <div class="form-group">
                        <label>Player</label>
                        <input type="text" id="c-player" class="v-input" placeholder="Your Name">
                    </div>
                    <div class="form-group">
                        <label>Chronicle</label>
                        <input type="text" id="c-chronicle" class="v-input" placeholder="Chronicle Name">
                    </div>
                    <div class="form-group">
                        <label>Clan</label>
                        <select id="c-clan" class="v-input"><option>Loading...</option></select>
                    </div>
                    <div class="form-group">
                        <label>Nature</label>
                        <select id="c-nature" class="v-input"><option>Loading...</option></select>
                    </div>
                    <div class="form-group">
                        <label>Demeanor</label>
                        <select id="c-demeanor" class="v-input"><option>Loading...</option></select>
                    </div>
                    <div class="form-group">
                        <label>Generation</label>
                        <input type="number" id="c-gen" class="v-input" value="13" min="3" max="15">
                    </div>
                    <div class="form-group">
                        <label>Sire</label>
                        <input type="text" id="c-sire" class="v-input" placeholder="Name of Sire">
                    </div>
                </div>
                <button class="nav-next-btn" onclick="window.nextStep()">Attributes <i class="fas fa-chevron-right ml-2"></i></button>
            </div>

            <!-- === PHASE 2: ATTRIBUTES === -->
            <div id="phase-2" class="step-container">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="section-title mb-0">Attributes</h2>
                    <div class="text-xs text-gray-400">Prioritize: 7 / 5 / 3</div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Physical -->
                    <div class="attr-col">
                        <div class="flex justify-between items-center border-b border-[#333] mb-2 pb-1">
                            <h3 class="text-white font-cinzel">Physical</h3>
                            <div class="flex gap-1">
                                <button class="prio-btn" data-cat="attr" data-group="Physical" data-v="7">Primary</button>
                                <button class="prio-btn" data-cat="attr" data-group="Physical" data-v="5">Sec</button>
                                <button class="prio-btn" data-cat="attr" data-group="Physical" data-v="3">Tert</button>
                            </div>
                        </div>
                        <div class="text-right text-[10px] text-gray-500 mb-2">Points Left: <span id="p-phys" class="text-white">0</span></div>
                        <div id="list-attr-physical"></div>
                    </div>

                    <!-- Social -->
                    <div class="attr-col">
                        <div class="flex justify-between items-center border-b border-[#333] mb-2 pb-1">
                            <h3 class="text-white font-cinzel">Social</h3>
                            <div class="flex gap-1">
                                <button class="prio-btn" data-cat="attr" data-group="Social" data-v="7">Primary</button>
                                <button class="prio-btn" data-cat="attr" data-group="Social" data-v="5">Sec</button>
                                <button class="prio-btn" data-cat="attr" data-group="Social" data-v="3">Tert</button>
                            </div>
                        </div>
                        <div class="text-right text-[10px] text-gray-500 mb-2">Points Left: <span id="p-social" class="text-white">0</span></div>
                        <div id="list-attr-social"></div>
                    </div>

                    <!-- Mental -->
                    <div class="attr-col">
                        <div class="flex justify-between items-center border-b border-[#333] mb-2 pb-1">
                            <h3 class="text-white font-cinzel">Mental</h3>
                            <div class="flex gap-1">
                                <button class="prio-btn" data-cat="attr" data-group="Mental" data-v="7">Primary</button>
                                <button class="prio-btn" data-cat="attr" data-group="Mental" data-v="5">Sec</button>
                                <button class="prio-btn" data-cat="attr" data-group="Mental" data-v="3">Tert</button>
                            </div>
                        </div>
                        <div class="text-right text-[10px] text-gray-500 mb-2">Points Left: <span id="p-mental" class="text-white">0</span></div>
                        <div id="list-attr-mental"></div>
                    </div>
                </div>
                <button class="nav-next-btn" onclick="window.nextStep()">Abilities <i class="fas fa-chevron-right ml-2"></i></button>
            </div>

            <!-- === PHASE 3: ABILITIES === -->
            <div id="phase-3" class="step-container">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="section-title mb-0">Abilities</h2>
                    <div class="text-xs text-gray-400">Prioritize: 13 / 9 / 5 (Max 3 dots)</div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Talents -->
                    <div class="abil-col">
                        <div class="flex justify-between items-center border-b border-[#333] mb-2 pb-1">
                            <h3 class="text-white font-cinzel">Talents</h3>
                            <div class="flex gap-1">
                                <button class="prio-btn" data-cat="abil" data-group="Talents" data-v="13">Pri</button>
                                <button class="prio-btn" data-cat="abil" data-group="Talents" data-v="9">Sec</button>
                                <button class="prio-btn" data-cat="abil" data-group="Talents" data-v="5">Ter</button>
                            </div>
                        </div>
                        <div class="text-right text-[10px] text-gray-500 mb-2">Points Left: <span id="p-tal" class="text-white">0</span></div>
                        <div id="list-abil-talents"></div>
                        <div class="border-t border-[#333] mt-2 pt-2">
                            <div class="text-[10px] text-gray-500 mb-1">Custom Talents:</div>
                            <div id="custom-talents"></div>
                        </div>
                    </div>

                    <!-- Skills -->
                    <div class="abil-col">
                        <div class="flex justify-between items-center border-b border-[#333] mb-2 pb-1">
                            <h3 class="text-white font-cinzel">Skills</h3>
                            <div class="flex gap-1">
                                <button class="prio-btn" data-cat="abil" data-group="Skills" data-v="13">Pri</button>
                                <button class="prio-btn" data-cat="abil" data-group="Skills" data-v="9">Sec</button>
                                <button class="prio-btn" data-cat="abil" data-group="Skills" data-v="5">Ter</button>
                            </div>
                        </div>
                        <div class="text-right text-[10px] text-gray-500 mb-2">Points Left: <span id="p-ski" class="text-white">0</span></div>
                        <div id="list-abil-skills"></div>
                        <div class="border-t border-[#333] mt-2 pt-2">
                            <div class="text-[10px] text-gray-500 mb-1">Custom Skills:</div>
                            <div id="custom-skills"></div>
                        </div>
                    </div>

                    <!-- Knowledges -->
                    <div class="abil-col">
                        <div class="flex justify-between items-center border-b border-[#333] mb-2 pb-1">
                            <h3 class="text-white font-cinzel">Knowledges</h3>
                            <div class="flex gap-1">
                                <button class="prio-btn" data-cat="abil" data-group="Knowledges" data-v="13">Pri</button>
                                <button class="prio-btn" data-cat="abil" data-group="Knowledges" data-v="9">Sec</button>
                                <button class="prio-btn" data-cat="abil" data-group="Knowledges" data-v="5">Ter</button>
                            </div>
                        </div>
                        <div class="text-right text-[10px] text-gray-500 mb-2">Points Left: <span id="p-kno" class="text-white">0</span></div>
                        <div id="list-abil-knowledges"></div>
                        <div class="border-t border-[#333] mt-2 pt-2">
                            <div class="text-[10px] text-gray-500 mb-1">Custom Knowledges:</div>
                            <div id="custom-knowledges"></div>
                        </div>
                    </div>
                </div>
                <button class="nav-next-btn" onclick="window.nextStep()">Advantages <i class="fas fa-chevron-right ml-2"></i></button>
            </div>

            <!-- === PHASE 4: ADVANTAGES === -->
            <div id="phase-4" class="step-container">
                <h2 class="section-title">Advantages</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Disciplines -->
                    <div>
                        <div class="flex justify-between border-b border-[#333] mb-2">
                            <h3 class="text-white font-cinzel">Disciplines</h3>
                            <span class="text-xs text-gray-400">Points: <span id="p-disc" class="text-white">3</span></span>
                        </div>
                        <div id="list-disc"></div>
                    </div>

                    <!-- Backgrounds -->
                    <div>
                        <div class="flex justify-between border-b border-[#333] mb-2">
                            <h3 class="text-white font-cinzel">Backgrounds</h3>
                            <span class="text-xs text-gray-400">Points: <span id="p-back" class="text-white">5</span></span>
                        </div>
                        <div id="list-back"></div>
                    </div>

                    <!-- Virtues -->
                    <div>
                        <div class="flex justify-between border-b border-[#333] mb-2">
                            <h3 class="text-white font-cinzel">Virtues</h3>
                            <span class="text-xs text-gray-400">Points: <span id="p-virt" class="text-white">7</span></span>
                        </div>
                        <div id="list-virt">
                            <div id="virt-conscience"></div>
                            <div id="virt-self-control"></div>
                            <div id="virt-courage"></div>
                        </div>
                        <!-- Path selection -->
                        <div class="mt-4 pt-4 border-t border-[#333]">
                            <label class="text-xs uppercase font-bold text-gray-500">Path of Enlightenment</label>
                            <select id="c-path-name-create" class="v-input mt-1"></select>
                        </div>
                    </div>
                </div>
                <button class="nav-next-btn" onclick="window.nextStep()">Social & Merits <i class="fas fa-chevron-right ml-2"></i></button>
            </div>

            <!-- === PHASE 5: SOCIAL (Merits/Flaws/Etc) === -->
            <div id="phase-5" class="step-container">
                <h2 class="section-title">Social & Supernatural Details</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-white font-cinzel border-b border-[#333] mb-2">Merits</h3>
                        <div id="merits-list-create"></div>
                        
                        <h3 class="text-white font-cinzel border-b border-[#333] mb-2 mt-6">Flaws</h3>
                        <div id="flaws-list-create"></div>
                    </div>
                    <div>
                        <h3 class="text-white font-cinzel border-b border-[#333] mb-2">Derangements</h3>
                        <div id="derangements-list"></div>

                        <h3 class="text-white font-cinzel border-b border-[#333] mb-2 mt-6">Blood Bonds</h3>
                        <div id="blood-bond-list"></div>
                        
                        <h3 class="text-white font-cinzel border-b border-[#333] mb-2 mt-6">Havens</h3>
                        <div id="multi-haven-list"></div>
                    </div>
                </div>
                <button class="nav-next-btn" onclick="window.nextStep()">Gear <i class="fas fa-chevron-right ml-2"></i></button>
            </div>

            <!-- === PHASE 6: GEAR === -->
            <div id="phase-6" class="step-container">
                <h2 class="section-title">Inventory</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-white font-cinzel mb-2">Carried Gear</h3>
                        <div id="inv-list-carried" class="min-h-[100px] border border-[#333] bg-black/30 p-2"></div>
                        
                        <h3 class="text-white font-cinzel mb-2 mt-4">Owned / Stored Gear</h3>
                        <div id="inv-list-owned" class="min-h-[100px] border border-[#333] bg-black/30 p-2"></div>
                    </div>
                    <div>
                         <h3 class="text-white font-cinzel mb-2">Vehicles</h3>
                         <div id="vehicle-list" class="min-h-[100px] border border-[#333] bg-black/30 p-2 mb-4"></div>
                         
                         <!-- Simple Add Item UI -->
                         <div class="bg-[#111] p-4 border border-[#333]">
                             <h4 class="text-xs uppercase font-bold text-gray-400 mb-2">Add New Item</h4>
                             <input id="new-item-name" class="v-input mb-2" placeholder="Item Name">
                             <div class="flex gap-2">
                                 <select id="new-item-type" class="v-input w-1/3">
                                     <option value="Item">Item</option>
                                     <option value="Weapon">Weapon</option>
                                     <option value="Armor">Armor</option>
                                     <option value="Vehicle">Vehicle</option>
                                 </select>
                                 <button class="bg-[#d4af37] text-black font-bold px-4 text-xs uppercase" onclick="window.addItem()">Add</button>
                             </div>
                         </div>
                    </div>
                </div>
                <button class="nav-next-btn" onclick="window.nextStep()">Biography <i class="fas fa-chevron-right ml-2"></i></button>
            </div>

            <!-- === PHASE 7: BIO === -->
            <div id="phase-7" class="step-container">
                <h2 class="section-title">Biography</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs uppercase text-gray-500 mb-1">Appearance</label>
                        <textarea id="bio-appearance" class="v-textarea h-32"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs uppercase text-gray-500 mb-1">History / Prelude</label>
                        <textarea id="bio-history" class="v-textarea h-32"></textarea>
                    </div>
                    <div class="col-span-1 md:col-span-2">
                        <label class="block text-xs uppercase text-gray-500 mb-1">Notes / Coterie</label>
                        <textarea id="bio-notes" class="v-textarea h-24"></textarea>
                    </div>
                </div>
                <button class="nav-next-btn" onclick="window.nextStep()">Finalize <i class="fas fa-chevron-right ml-2"></i></button>
            </div>

            <!-- === PHASE 8: FINISH === -->
            <div id="phase-8" class="step-container">
                <h2 class="section-title">Final Touches</h2>
                <div class="flex flex-col items-center justify-center text-center mt-10">
                    <p class="text-gray-400 mb-6 max-w-lg">Review your character. Verify your dots, calculate your freebie points, and finalize your Humanity and Willpower.</p>
                    
                    <div class="grid grid-cols-2 gap-12 mb-8 w-full max-w-lg">
                        <div>
                            <h3 class="font-cinzel text-white mb-2">Humanity</h3>
                            <div id="phase8-humanity-dots" class="flex justify-center"></div>
                        </div>
                        <div>
                            <h3 class="font-cinzel text-white mb-2">Willpower</h3>
                            <div id="phase8-willpower-dots" class="flex justify-center"></div>
                        </div>
                    </div>

                    <div class="bg-red-900/20 border border-red-900 p-4 mb-8">
                        <div class="text-red-400 font-cinzel text-xl mb-2">Spending Freebie Points</div>
                        <p class="text-xs text-gray-400 mb-4">You have <input id="c-freebie-total" type="number" value="15" class="bg-black border border-[#555] text-white w-12 text-center"> points.</p>
                        <!-- Only visible in freebie mode via JS toggle -->
                        <div id="freebie-sidebar" class="hidden text-left text-xs space-y-1">
                             <div class="flex justify-between"><span>Attributes:</span><span id="sb-attr" class="text-white">0</span></div>
                             <div class="flex justify-between"><span>Abilities:</span><span id="sb-abil" class="text-white">0</span></div>
                             <div class="flex justify-between"><span>Disciplines:</span><span id="sb-disc" class="text-white">0</span></div>
                             <div class="flex justify-between"><span>Backgrounds:</span><span id="sb-back" class="text-white">0</span></div>
                             <div class="flex justify-between"><span>Virtues:</span><span id="sb-virt" class="text-white">0</span></div>
                             <div class="flex justify-between"><span>Humanity:</span><span id="sb-human" class="text-white">0</span></div>
                             <div class="flex justify-between"><span>Willpower:</span><span id="sb-will" class="text-white">0</span></div>
                             <div class="flex justify-between border-t border-red-900 pt-1 mt-1 text-gold font-bold"><span>Remaining:</span><span id="sb-total">15</span></div>
                        </div>
                    </div>

                    <button class="bg-[#d4af37] text-black font-cinzel text-xl px-8 py-3 uppercase tracking-widest hover:bg-white transition-all shadow-lg" onclick="window.togglePlayMode()">
                        Enter Play Mode
                    </button>
                </div>
            </div>

            <!-- === PLAY MODE LAYOUT (Hidden by default) === -->
            <!-- 1. Header Info -->
            <div id="play-mode-1" class="hidden play-section mb-6">
                <div id="play-concept-row" class="grid grid-cols-3 text-lg font-cinzel text-white border-b border-[#d4af37] pb-2"></div>
            </div>

            <!-- 2. Attributes & Abilities -->
            <div id="play-mode-2" class="hidden play-section mb-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div id="play-row-attr" class="grid grid-cols-3 gap-4 text-xs"></div>
                    <div id="play-row-abil" class="grid grid-cols-3 gap-4 text-xs"></div>
                </div>
            </div>

            <!-- 3. Advantages & Status -->
            <div id="play-mode-3" class="hidden play-section mb-6">
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                     <div id="play-row-adv" class="grid grid-cols-3 gap-4 text-xs"></div>
                     
                     <!-- Status Blocks -->
                     <div class="space-y-6">
                         <!-- Humanity / Willpower / Blood -->
                         <div class="bg-black/40 border border-[#333] p-4">
                             <h3 class="section-title text-center text-sm mb-2">Vitals</h3>
                             
                             <div class="mb-2">
                                 <div class="flex justify-between text-xs uppercase mb-1"><span>Humanity / Path</span></div>
                                 <div id="humanity-dots-play" class="flex justify-center"></div>
                             </div>
                             
                             <div class="mb-2">
                                 <div class="flex justify-between text-xs uppercase mb-1"><span>Willpower</span></div>
                                 <div id="willpower-dots-play" class="flex justify-center mb-1"></div>
                                 <div id="willpower-boxes-play" class="flex justify-center gap-1"></div>
                             </div>
                             
                             <div>
                                 <div class="flex justify-between text-xs uppercase mb-1"><span>Blood Pool</span></div>
                                 <div id="blood-boxes-play" class="flex flex-wrap justify-center gap-1 px-4"></div>
                             </div>
                         </div>
                         
                         <!-- Health -->
                         <div class="bg-black/40 border border-[#333] p-4">
                             <h3 class="section-title text-center text-sm mb-2">Health</h3>
                             <div id="health-chart-play"></div>
                         </div>
                     </div>
                 </div>
            </div>

            <!-- 4. Combat & Gear -->
            <div id="play-mode-4" class="hidden play-section">
                <h2 class="section-title">Combat</h2>
                <div class="bg-black/40 border border-[#333] p-2 mb-4">
                    <div class="grid grid-cols-6 gap-2 text-[10px] uppercase font-bold text-gray-500 border-b border-[#333] pb-1 mb-1 text-center">
                        <div class="col-span-2 text-left pl-2">Weapon</div>
                        <div>Diff</div>
                        <div>Dmg</div>
                        <div>Range</div>
                        <div>Clip</div>
                    </div>
                    <div id="combat-list-create"></div>
                </div>
                
                <div class="flex justify-between text-xs text-gray-400 border-t border-[#333] pt-2">
                    <div>Armor: <span id="active-armor-names" class="text-white">None</span></div>
                    <div>Rating: <span id="total-armor-rating" class="text-gold">0</span></div>
                    <div>Penalty: <span id="total-armor-penalty" class="text-red-500">0</span></div>
                </div>
            </div>

        </main>

        <!-- FOOTER / DICE TRAY -->
        <footer id="dice-tray" class="bg-[#050505] border-t border-[#333] p-4 transition-all duration-300">
            <div class="flex justify-between items-end">
                <div class="flex-1">
                    <div id="pool-display" class="text-sm font-cinzel text-gray-400 mb-2">Select traits to build pool...</div>
                    <div class="flex items-center gap-4">
                        <button id="roll-btn" class="bg-[#8b0000] hover:bg-red-700 text-white px-6 py-2 font-cinzel font-bold shadow-lg shadow-red-900/20 active:translate-y-0.5 transition-all">
                            ROLL
                        </button>
                        <button id="clear-pool-btn" class="text-xs text-gray-500 uppercase hover:text-white">Clear</button>
                    </div>
                </div>
                
                <div class="flex flex-col items-end gap-2">
                    <div class="flex items-center gap-2">
                         <label class="text-[10px] uppercase text-gray-500">Difficulty</label>
                         <input type="number" id="roll-diff" value="6" min="2" max="10" class="bg-[#222] text-white border border-[#444] w-10 text-center text-sm">
                    </div>
                    <label class="flex items-center gap-2 cursor-pointer group">
                        <input type="checkbox" id="use-specialty" class="peer sr-only">
                        <div class="w-3 h-3 border border-[#444] bg-[#111] peer-checked:bg-[#d4af37] transition-all"></div>
                        <span class="text-[10px] uppercase text-gray-500 group-hover:text-gray-300">Specialty?</span>
                    </label>
                </div>
            </div>
            
            <!-- Roll Results Feed -->
            <div id="roll-results" class="mt-4 max-h-32 overflow-y-auto custom-scrollbar flex flex-col gap-1"></div>
        </footer>

    </div>

    <!-- MODAL: SAVE -->
    <div id="save-modal" class="fixed inset-0 bg-black/80 z-50 hidden flex items-center justify-center backdrop-blur-sm">
        <div class="bg-[#111] border border-[#333] p-6 w-96 shadow-2xl">
            <h3 class="font-cinzel text-xl text-white mb-4">Inscribe Character</h3>
            <label class="block text-xs uppercase text-gray-500 mb-1">Filename</label>
            <input id="save-name-input" class="v-input mb-4">
            
            <label class="block text-xs uppercase text-gray-500 mb-1">Folder / Chronicle</label>
            <input id="save-folder-input" class="v-input mb-6" list="folder-datalist">
            <datalist id="folder-datalist"></datalist>
            
            <div class="flex justify-end gap-2">
                <button class="px-4 py-2 text-gray-400 hover:text-white" onclick="document.getElementById('save-modal').classList.remove('active')">Cancel</button>
                <button id="confirm-save-btn" class="px-6 py-2 bg-[#d4af37] text-black font-bold uppercase hover:bg-white">Save</button>
            </div>
        </div>
    </div>

    <!-- MODAL: LOAD -->
    <div id="load-modal" class="fixed inset-0 bg-black/80 z-50 hidden flex items-center justify-center backdrop-blur-sm">
        <div class="bg-[#111] border border-[#333] w-full max-w-2xl h-[80vh] flex flex-col shadow-2xl">
            <div class="p-4 border-b border-[#333] flex justify-between items-center">
                <h3 class="font-cinzel text-xl text-white">Archives</h3>
                <button class="text-gray-500 hover:text-white text-xl" onclick="document.getElementById('load-modal').classList.remove('active')">&times;</button>
            </div>
            <div id="file-browser" class="flex-1 overflow-y-auto p-4 custom-scrollbar"></div>
        </div>
    </div>

    <!-- WALKTHROUGH GUIDE (Floating) -->
    <div id="walkthrough-guide" class="fixed bottom-24 right-6 flex flex-col items-end z-40 transition-opacity duration-500">
        <div id="guide-message" class="bg-black/90 border border-[#d4af37] text-[#f0e6d2] px-4 py-2 rounded text-xs font-bold shadow-lg w-48 text-right mb-2">
            Initialize...
        </div>
        <div id="guide-icon" class="w-12 h-12 rounded-full bg-[#111] border-2 border-[#d4af37] flex items-center justify-center text-[#d4af37] shadow-[0_0_15px_rgba(212,175,55,0.3)] animate-bounce cursor-pointer hover:scale-110 transition-transform" onclick="window.nextStep()">
            <i class="fas fa-chevron-down"></i>
        </div>
    </div>

    <!-- FIREBASE MODULES -->
    <script type="module" src="script.js"></script>
</body>
</html>
